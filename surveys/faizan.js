const response = {
  filetest: "",
  haris: "",
  Guest: "",
  Message: "",
  "1rBV3BKNTM9pV8lZHyQy": "",
  "Invoice Total": "",
  "Test Ahmad": "",
  "Last Charge Date": "",
  Tax: "",
  checkboxprice: "",
  "Real Last Status Date": "",
  Notes: "",
  "Test Field": "",
  "Custom name": "",
  Date: "",
  "Invoice Items": "",
  "Created Date": "",
  Result: "",
  "Real Study Id": "",
  TotalAmount: "",
  items_description: "",
  NYehSwKKeIuquCsbWZ0o: "",
  "Is Default": "",
  "Field 2": "",
  "Titan Location Id": "",
  "Selected an activity Fector": "",
  Sabir: "",
  "Business Unit": "",
  "tax 10%": "",
  "Real Recruitment Study": "",
  "Last Payment Status": "",
  "Text Area": "",
  "Test Fields3": "",
  Sajjad: "",
  "Titan Customer Id": "",
  pricetotal: "",
  PgtYvXF10GwTKcJKEicr: "",
  large: "",
  "Field 1": "",
  D: "",
  file: "",
  A: "",
  "Message-1": "",
  "Multiple option": "",
  "Job Type": "",
  C: "",
  Abdullah: "",
  "Select Option": "",
  Sex: "",
  "Numeric 3": "",
  Priority: "",
  price_cc: "",
  B: "",
  Width: "",
  "Invoice Id By Ahmed": "",
  "Test Field2": "",
  Campaign: "",
  "radio with image": "",
  TExtlist: "",
  "Real Recruitment Status": "",
  "Numeric 2": "",
  SingleOPtion: "",
  Gender: "",
  Vehicle: "",
  VIN: "",
  "Exterior Color": "",
  Mileage: "",
  "KBB Instant Offer": "",
  "Best Time To Contact": "",
  "Best Type To Contact": "",
  "KBB Instant Offer Link": "",
  "Contact Source": "",
  "Complete Comment": "",
  "test signature": "",
  Signature: "",
  "I agree to the terms, conditions, and policies of this agreement": "",
  "Spouse's Date of Birth MM-DD-YYYY *": "",
  "Dependent 1 Date of Birth MM-DD-YYYY": "",
  "Authorization Signature - I authorize you to be my Agent of Record each month until I revoke consent and re-enroll me in the best plan during Open Enrollment if my current plan is discontinued.":
    "",
  "Dependent 2 Date of Birth MM-DD-YYYY": "",
  "Dependent 3 Date of Birth MM-DD-YYYY": "",
  "Dependent 4 Date of Birth MM-DD-YYYY": "",
  "Dependent 5 Date of Birth MM-DD-YYYY": "",
  "Authorized Person (Legal Guardian)": "Quia ex laborum iure",
  "Authorized Person Signature": {
    meta: {
      fieldname: "sh3cgl85dSDA3nV7A9Ev",
      size: 5083,
      isSignature: true,
      originalname: "sign-timestamp-1705407359.png",
      mimetype: "image/png",
      encoding: "7bit",
      uuid: "098da4af-aeb0-496d-98a8-b0cfedee37a0",
      timestamp: "1705407359",
    },
    url: "https://storage.googleapis.com/contact-attachments-live/Q6sATpsoSLCPFf5ErtoF/fGkO5vzTTJEmsvf1fF6m/2c41e1bf-d3d1-4778-bc50-9a75e9aa033d.png",
  },
  Relationship: "Voluptates illo qui ",
  "Patient HIPAA Signature": {
    meta: {
      fieldname: "dWlhk9Es9XgLOtxlealY",
      size: 5210,
      isSignature: true,
      originalname: "sign-timestamp-1705407359.png",
      mimetype: "image/png",
      encoding: "7bit",
      uuid: "d1c918a2-6a44-4e38-a273-2dbd1fa49d0a",
      timestamp: "1705407359",
    },
    url: "https://storage.googleapis.com/contact-attachments-live/Q6sATpsoSLCPFf5ErtoF/fGkO5vzTTJEmsvf1fF6m/5b358fa5-2a40-4ce4-93e9-6d8f05e055f7.png",
  },
  "Name of Patient (Printed)": "Voluptatum aut aut a",
  "Consent Signature Patient": {
    meta: {
      fieldname: "GTpEtHO9ABVbIISR8hdS",
      size: 4501,
      isSignature: true,
      originalname: "sign-timestamp-1705405897.png",
      mimetype: "image/png",
      encoding: "7bit",
      uuid: "af400126-7f13-431c-b47b-262cfc750d32",
      timestamp: "1705405897",
    },
    url: "https://storage.googleapis.com/contact-attachments-live/Q6sATpsoSLCPFf5ErtoF/fGkO5vzTTJEmsvf1fF6m/2d82ddfd-38e2-4e13-9dcd-d8c751759dd3.png",
  },
  "Witness Name": "Quisquam illo esse ",
  "Witness Signature": {
    meta: {
      fieldname: "yEy2Ib8fhaY9TsrhNDm5",
      size: 6100,
      isSignature: true,
      originalname: "sign-timestamp-1705405898.png",
      mimetype: "image/png",
      encoding: "7bit",
      uuid: "f0daec60-2e5f-4b56-8feb-f8b79fd8d812",
      timestamp: "1705405898",
    },
    url: "https://storage.googleapis.com/contact-attachments-live/Q6sATpsoSLCPFf5ErtoF/fGkO5vzTTJEmsvf1fF6m/f53bd3bf-6ac4-40c4-9b41-014d30d50a95.png",
  },
  "Physician Name": "Veniam cum nulla co",
  "Patient Name": "Dolore sit anim cum",
  "Return Policy Acknowledged Signature": {
    meta: {
      fieldname: "BqFgyRxJ4vEVGXczpKRO",
      size: 6080,
      isSignature: true,
      originalname: "sign-timestamp-1705405901.png",
      mimetype: "image/png",
      encoding: "7bit",
      uuid: "698ef71d-af01-4bff-9435-247f3f558fed",
      timestamp: "1705405901",
    },
    url: "https://storage.googleapis.com/contact-attachments-live/Q6sATpsoSLCPFf5ErtoF/fGkO5vzTTJEmsvf1fF6m/f28e71c8-60ff-4b88-b0a5-736fb6c81f0b.png",
  },
  "Jersey Weight Loss Clinic Representative": "Dolore delectus off",
  "Payment Term Accepted Date": "",
  "Invoice No": "",
  "Invoice Date": "",
  Products: "",
  "Last Invoice Type": "",
  "Payment Status": "",
  "Grand Total": "",
  "Invoice Link": "",
  "Terms Accepted Date": "",
  Radio: "",
  Dropdown: "",
  "Dropdown Single": "",
  Checkbox: "",
  "Total Amount": "",
  "Total Paid": "",
  offer: "",
  "OFFER PRICE": "",
  "Onboarding - Company Color 1 (HEX Code)": "",
  "Onboarding - Company Color 2 (HEX Code)": "",
  "Onboarding - CompanyHexaColor1": "",
  "What's Your Favorite Season?": "",
  "Upload Your File": "",
  "fm - userName": "",
  "fm - userEmail": "",
  "Portal Password": "",
  "How would you rate us?": "",
  "Your Feedback": "",
  "Report Data": "",
  "Report User Id": "",
  "Report Date": "",
  "cv-First Name": "",
  "cv-Last Name": "",
  "agent email": "",
  "owner email": "",
  "Onboarding- Brand Color": "",
  "Onboarding- Brand Logo": "",
  "Onboarding-LogoLine": "",
  "Onboarding- Brand Color #1": "",
  "Onboarding- Brand Color #2": "",
  "cv- Agent Name": "",
  "cv-Full": "",
  "cv-Investor Brand Business Name": "",
  "cv-Investor Brand Full Name": "",
  "cv-Investor Brand Email": "",
  "cv-Investor Brand Phone": "",
  "cv-Investor Brand Address": "",
  "cv-Investor Brand City": "",
  "Embed Code": "",
  "IP Address": "",
  "Trusted Form Cert Url": "",
  "Trusted Form Ping Url": "",
  "What marketing strategy piques your interest?": "",
  PDF: "",
  "My Electric Bill": "",
  "Roof Top": "",
  "What is the total volume of your syringe?": "",
  "How much bacteriostatic water are you adding?": "",
  "Select Peptide Vial Quality": "",
  "peptide-mcg": "",
  "Enter your Street adress to start!": "",
  "Do You Have A Spouse?": "",
  "Primary Applicant's Social Security Number": "",
  "Spouse Legal First Name": "",
  "Spouse Legal Last Name": "",
  "Spouse's Gender": "",
  "Dependent 1 Gender": "",
  "Authorization Date": "",
  "Dependent 2 Full Legal Name": "",
  "Dependent 2 Gender": "",
  "Do You Have a 2nd Dependent?": "",
  "Do You Have a 3rd Dependent?": "",
  "Dependent 3 Full Legal Name": "",
  "Do You Have a 4th Dependent?": "",
  "Dependent 4 Full Legal Name": "",
  "Do You Have a 5th Dependent?": "",
  "Dependent 5 Full Legal Name": "",
  "Dependent 3 Gender": "",
  "Dependent 4 Gender": "",
  "Dependent 5 Gender": "",
  "Dependent 1 Full Legal Name": "",
  "MAIN HUN KN": "",
  puppy_name: "",
  puppy_breed: "",
  microchip_number: "",
  puppy_dob: "",
  pickup_date: "",
  "Is this *": "",
  "Is this": "",
  estimatedHousholdIncome: "",
  "I give permission to Monarch Insurance Agency LLC and itâ€™s affiliates to access and/or create my application for health insurance on the Federally Facilitated Marketplace (FFM) based on the information I am providing below.":
    "",
  "Do you have insurance through your employer, Medicare, Medicaid or VA?": "",
  "Social Security Number": "",
  "Marital Status": "",
  "Which $0 plan carriers are you interested in? ": "",
  "Income Verification": "",
  "Do you Agree with the Income Verification? ": "",
  "Do you Agree with the Consent?": "",
  "Consent to Enrollment; Verification of Information": "",
  "Authorization and Tax attestation": "",
  "Consent Acknowledgement": "",
  "Do you Agree with Consent Acknowledgement? ": "",
  "Do you Agree with Authorization and Tax attestation?": "",
  "Will you be claiming any dependents on your taxes in 2023? ": "",
  "Spouse First Name": "",
  " Spouse Last Name ": "",
  "Spouse Date of Birth": "",
  "Spouse SSN (Only if adding to the plan)": "",
  "Dependent First Name": "",
  "Dependent Last Name": "",
  "Dependent Gender": "",
  "Dependent Date of Birth": "",
  "Dependent SSN (if adding to plan)": "",
  "Spouse Gender ": "",
  "list name": "",
  "Faizan Lead Counter": "",
  "Husnain Lead Counter": "",
  "Report All Data": "",
  "Chat GPT": "",
  "Lead Response": "",
  Memory: "",
  stt: "",
  "Do You Have Any Dependents?": "",
  "Do You Have A Spouse ?": "",
  "Spouse's Date of Birth MM-DD-YYYY": "",
  "booked by": "",
  "Emergency Contact Phone Number": "",
  "Weight Goal (lbs.)": "",
  "Relationship with this person": "",
  "Do you need a personal trainer?": "",
  "Your Age": "",
  "Current Weight (lbs.)": "",
  contact_id: "fGkO5vzTTJEmsvf1fF6m",
  first_name: "Shelley",
  last_name: "Mack",
  full_name: "Shelley Mack",
  phone: "+15674865991",
  tags: "",
  country: "IL",
  timezone: "Asia/Karachi",
  date_created: "2024-01-15T19:36:32.366Z",
  contact_source: "hipaa privacy notice",
  full_address: "",
  contact_type: "lead",
  gclid: null,
  location: {
    name: "WEB DEVELOPER",
    address: "Street address",
    city: "City",
    state: "State",
    country: "IL",
    postalCode: "54000",
    fullAddress: "Street address, City State 54000",
    id: "Q6sATpsoSLCPFf5ErtoF",
  },
  workflow: {
    id: "0353d44b-d980-419e-bbd7-f89e969f467f",
    name: "New Workflow : 1705346577744",
  },
  contact: {
    attributionSource: {
      utmSource: null,
      ip: "39.62.6.46",
      utmTerm: null,
      mediumId: "QzQEm1T0fMRPopwyOYkI",
      utmContent: null,
      userAgent:
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
      medium: "survey",
      url: "https://api.leadconnectorhq.com/widget/survey/QzQEm1T0fMRPopwyOYkI",
      referrer: null,
      gclid: null,
      sessionSource: "Direct traffic",
      campaign: null,
      utmMedium: null,
      gaClientId: null,
    },
    lastAttributionSource: {
      utmSource: null,
      ip: "39.62.6.46",
      utmTerm: null,
      mediumId: "QzQEm1T0fMRPopwyOYkI",
      utmContent: null,
      userAgent:
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
      medium: "survey",
      url: "https://api.leadconnectorhq.com/widget/survey/QzQEm1T0fMRPopwyOYkI?contact_id=fGkO5vzTTJEmsvf1fF6m",
      referrer: null,
      gclid: null,
      sessionSource: "Direct traffic",
      utmMedium: null,
      gaClientId: null,
    },
  },
  attributionSource: {
    sessionSource: "Direct traffic",
    url: "https://api.leadconnectorhq.com/widget/survey/QzQEm1T0fMRPopwyOYkI",
    campaign: null,
    utmSource: null,
    utmMedium: null,
    utmContent: null,
    utmTerm: null,
    referrer: null,
    gclid: null,
    userAgent:
      "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
    ip: "39.62.6.46",
    gaClientId: null,
    medium: "survey",
    mediumId: "QzQEm1T0fMRPopwyOYkI",
  },
  customData: {},
};

function getInput(selector, multi) {
  const findWith = ["data-q", "name", "id", "class"]
    .map((key) => `input[${key} *= "${selector}"]`)
    .join(",");
  let input = document.querySelectorAll(findWith);
  if (!input.length) {
    let labels = document.querySelectorAll("label");
    input = Array.from(labels)
      .filter((x) => x.innerText.toLowerCase().includes(selector.toLowerCase()))
      .flatMap((x) => [
        ...(x
          .closest(".form-field-container")
          ?.querySelectorAll("input, canvas") ?? []),
      ]);
  }


  input = Array.from(input).map((el) => {
    if (el.tagName.toLowerCase() === "canvas") {
      // Clear existing content on the canvas
      const context = el.getContext("2d");
      context.clearRect(0, 0, el.width, el.height);

      // Update canvas content based on fieldValue (assumed to be an image URL)
      const fieldValue = response["https://storage.googleapis.com/contact-attachments-live/Q6sATpsoSLCPFf5ErtoF/fGkO5vzTTJEmsvf1fF6m/2c41e1bf-d3d1-4778-bc50-9a75e9aa033d.png"];
      if (fieldValue) {
        const img = new Image();
        img.onload = function () {
          context.drawImage(img, 0, 0, el.width, el.height);
        };
        img.src = fieldValue;
      }
    }
    return el;
  });

  return multi ? [...input] : input[0];
}


















  input = Array.from(input).map((el) => {
    if (el.tagName.toLowerCase() === "canvas") {
      // Clear existing content on the canvas
      const context = el.getContext("2d");
      context.clearRect(0, 0, el.width, el.height);

      // Update canvas content based on fieldValue
      const fieldValue = response[selector];
      context.fillText(fieldValue, 10, 10); // Assuming text-based update, adjust as needed
    }
    return el;
  });

  return multi ? [...input] : input[0];
}

function autofillForm() {
  for (const attribute in response) {
    if (response.hasOwnProperty(attribute)) {
      const fieldValue = response[attribute];

      const formField = getInput(attribute);
      if (formField && formField.type) {
        formField.value = fieldValue;
        formField.dispatchEvent(new Event("input"));
      } else {
        console.log("In Else:", attribute, formField);
      }
    }
  }
}

setTimeout(() => {
  autofillForm();
}, 2500);










































// real work
function updateCanvasContent(canvas, imageUrl) {
  const context = canvas.getContext("2d");
  context.clearRect(0, 0, canvas.width, canvas.height);

  if (imageUrl) {
    const img = new Image();
    img.onload = function () {
      context.drawImage(img, 0, 0, canvas.width, canvas.height);
    };
    img.src = "https://storage.googleapis.com/contact-attachments-live/Q6sATpsoSLCPFf5ErtoF/fGkO5vzTTJEmsvf1fF6m/5b358fa5-2a40-4ce4-93e9-6d8f05e055f7.png";
  }
}


function getInput(selector, multi) {
  const findWith = ["data-q", "name", "id", "class"]
    .map((key) => `input[${key} *= "${selector}"]`)
    .join(",");
  let input = document.querySelectorAll(findWith);

  if (!input.length) {
    let labels = document.querySelectorAll("label");
    input = Array.from(labels)
      .filter((x) => x.innerText.toLowerCase().includes(selector.toLowerCase()))
      .flatMap((x) => [
        ...(x.closest(".form-field-container")?.querySelectorAll("input, canvas") ?? []),
      ]);
  }

  input = Array.from(input).map((el) => {
    if (el.tagName.toLowerCase() === "Authorized Person Signature") {
      const fieldValue = response["Authorized Person Signature"];
      updateCanvasContent(el, fieldValue);
    }
    return el;
  });

  return multi ? [...input] : input[0];
}

function autofillForm() {
  for (const attribute in response) {
    if (response.hasOwnProperty(attribute)) {
      const fieldValue = response[attribute];
      const formField = getInput(attribute);
      
      if (formField && formField.type) {
        formField.value = fieldValue;
        formField.dispatchEvent(new Event("input"));
      } else {
        console.log("In Else:", attribute, formField);
      }
    }
  }
}



setTimeout(() => {
  autofillForm();
}, 2500);